<!DOCTYPE html>
<html lang="sk-SK">
<head>
	<!-- Primary Meta Tags -->
	<title>Upload firmvéru - WiFi termostat - ESP8266 / ESP32 - riadenie kotla</title>
	<meta name="description" content="Návod na upload - nahratie firmvéru projektu WiFi termostat do WiFi mikrokontorlérov ESP8266 a ESP32.">
	<meta name="keywords" content="Termostat, digitálny, arduino ide, wemos d1 mini, nodemcu, wifi, esp8266, vykurovanie, kúrenie, webserver, socket, http, web, ip, ipv4, ds18b20, onewire, 1-wire">
	<!-- Open Graph / Facebook -->
	<meta property="og:type" content="website">
	<meta property="og:url" content="https://martinius96.github.io/WiFi-termostat/spustenie.html">
	<meta property="og:title" content="Spustenie projektu - WiFi termostat - ESP8266 / ESP32 - riadenie kotla">
	<meta property="og:description" content="Návod na inštaláciu a spustenie projektu WiFi termostat postavenom na WiFi platforme ESP8266 a ESP32.">
	<meta property="og:image" content="">

	<!-- Twitter -->
	<meta property="twitter:card" content="summary_large_image">
	<meta property="twitter:url" content="https://martinius96.github.io/WiFi-termostat/spustenie.html">
	<meta property="twitter:title" content="Spustenie projektu - WiFi termostat - ESP8266 / ESP32 - riadenie kotla">
	<meta property="twitter:description" content="Návod na inštaláciu a spustenie projektu WiFi termostat postavenom na WiFi platforme ESP8266 a ESP32.">
	<meta property="twitter:image" content="">
	
	<link rel="icon" type="image/png" href="favicon.png">
	<link rel="sitemap" type="application/xml" title="Sitemap" href="../sitemap.xml" />
	<meta name="google-site-verification" content="UwZZh2EXv3iWUAi_1Z0hLxVCz6ySJ4UdY_BPoLtejwo" />    	
	<meta property='fb:admins' content='100001242570317'>
    	<meta charset="utf-8">
    	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
	<script type="text/javascript">
    		window.smartlook||(function(d) {
    			var o=smartlook=function(){ o.api.push(arguments)},h=d.getElementsByTagName('head')[0];
    			var c=d.createElement('script');o.api=new Array();c.async=true;c.type='text/javascript';
    			c.charset='utf-8';c.src='https://rec.smartlook.com/recorder.js';h.appendChild(c);
    		})(document);
    		smartlook('init', 'db50efe9fff280a17db52b82be221240cbbd3dbe');
	</script>  
	<style>
		table, th, td {
  			border: 1px solid black;
		}
	</style>	
<style>
	#right {
  position: absolute;
  right: 0px;
}
	</style>
</head>
<body>
	<div class="container">
  		<div class="row">
    			<div class="col-sm-12">
<nav class="navbar navbar-inverse">
  <div class="container-fluid">
    <div class="navbar-header">
      <a class="navbar-brand" href="index.html">WiFi termostat</a>
    </div>
    <ul class="nav navbar-nav">
      	<li class=""><a href="index.html">Prehľad</a></li>
	<li><a href="zapojenie.html">Zapojenie</a></li>      
	<li class="active"><a href="spustenie.html">Spustenie WiFi termostatu</a></li>
  <li><a href="json_client.html">JSON client</a></li>
      	<li><a href="kontakt.html">Kontakt</a></li>
<a href="de/spustenie.html"><img src="https://futbalovysen.sk/wp-content/uploads/germany.png" alt="Germany.png, 2,2kB" title="Germany" height="32" width="32"></a>
<a href="en/spustenie.html"><img src="https://i2.wp.com/facsusa.com/wp-content/uploads/2017/05/Flag-of-England.png?ssl=1" alt="English.png, 2,2kB" title="English" height="32" width="32"></a>
<li style="float: right; "><a href="https://martinius96.github.io/termostat-ethernet/" class="btn btn-danger" role="button" title="Zmeniť projekt na Ethernet termostat"><img src="https://i.imgur.com/6dW9TvK.png" width=16px height=16px> <font color="white">Ethernet termostat</font></a></li>  </ul>
  </div>
</nav>  
				<div class="alert alert-success">
					<strong>Projekt k repozitáru - Github: </strong><a href="https://github.com/martinius96/WiFi-termostat">WiFi termostat</a>
				</div>	
<div class="alert alert-danger">
 	<strong>Podporte projekt WiFi termostat cez PayPal. Podpora umožní pridať nové funkcionality v budúcnosti a otvorenie zdrojového kódu aplikácie: </strong><a href="https://www.paypal.com/paypalme/chlebovec" class="btn btn-primary" role="button">PayPal donate</a>
</div>	
<span class="label label-default">ESP8266</span>
<span class="label label-primary">ESP32</span>
<span class="label label-success">WiFi</span>
<span class="label label-info">DS18B20</span>
<span class="label label-warning">OneWire</span>
<span class="label label-danger">Dallas</span>
<span class="label label-default">HTML</span>
<span class="label label-primary">Webserver</span>
<span class="label label-success">WebSocket</span>
<span class="label label-info">JSON</span>
<span class="label label-warning">mDNS</span>	
<span class="label label-danger">UART</span>				
<hr><center><h2>Spustenie projektu WiFi termostat - ESP8266 / ESP32</h2></center><hr>
<p style="text-align: justify;">
Projekt WiFi termostat existuje existuje vo viacerých verziách, ktoré sú dostupné na Githube v repozitári celého projektu.
Verzie sa funkčnosťou líšia iba v možnosti prístupu k WiFi termostatu cez doménové meno v mDNS službe a v možnosti manuálneho režimu ovládania výstupu - GPIO.
Firmvér je dostupný v skompilovanom - binárnom tvare, ktorý je spustiteľný pre cieľovú platformu.
Tým pádom je vopred otestovaný a vyskúšaný pre cieľovú platformu. 
Firmvér je univerzálny, čo zaručuje, že bude fungovať s klonovaným - binárnym programom na všetkých mikrokontroléroch rovnako.
Prístupové údaje k WiFi sieti sú uložené v pamäti ESP32, stačí raz nakonfigurovať, ak už nie je daný záznam uložený z predchádzajúcich projektov.
<div class="alert alert-danger">
	<b>Free verzia je dostupná iba vo forme skompilovaného - binárneho programu bez prístupu k aplikácii napísanej v .ino formáte.</b>
</div>	
</p>
<hr><center><h2>Rozdelenie firmvéru na základe podporovaných WiFi platforiem</h2></center><hr>
<li><b>ESP8266</b> - cieľová platforma s čipom ESP8266 vo verzii 12E až 12F (napr. Wemos D1 Mini, NodeMCU) - (podmienené flash metódou DIO)</li>
<li><b>ESP32</b> - cieľová platforma s čipom ESP-32S (AI-Thinker), ESP32-WROOM-32 (Espressif Systems) - (podmienené flash metódou DIO)</li>
<hr><center><h2>Rozdelenie firmvéru na základe funkcie</h2></center><hr>
			<center>
<div class="table-responsive">   
<table class="table" style="border: 1px solid black;">
<thead>
<tr>
<th>Názov zložky firmvéru</th>
<th>Funkcie firmvéru</th>
<th>ESP8266</th>
<th>ESP32</th>
</tr>
</thead>
<tbody>
<tr>
<td><b>WiFi_TERMOSTAT</b></td>
<td>Termostat s možnosťou nastavenia cieľovej teploty a hysterézy cez webové rozhranie, riadený automaticky</td>
<td><a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/martinius96/WiFi-termostat/tree/main/firmware/ESP8266/WiFi_TERMOSTAT" class="btn btn-success" role="button">ESP8266 firmvér</a></td>
<td><a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/martinius96/WiFi-termostat/tree/main/firmware/ESP32/WiFi_TERMOSTAT" class="btn btn-danger" role="button">ESP32 firmvér</a></td>
</tr>
<tr>
<td><b>WiFi_TERMOSTAT_mDNS</b></td>
<td>Termostat s možnosťou nastavenia cieľovej teploty a hysterézy cez webové rozhranie, riadený automaticky. Možnosť využiť doménové meno v rámci LAN siete (mDNS záznam)</td>
<td><a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/martinius96/WiFi-termostat/tree/main/firmware/ESP8266/WiFi_TERMOSTAT_mDNS" class="btn btn-success" role="button">ESP8266 firmvér</a></td>
<td><a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/martinius96/WiFi-termostat/tree/main/firmware/ESP32/WiFi_Termostat_mDNS" class="btn btn-danger" role="button">ESP32 firmvér</a></td>
</tr>
<tr>
<td><b>WiFi_TERMOSTAT_MANUAL_experimental</b></td>
<td>Termostat s možnosťou nastavenia cieľovej teploty a hysterézy cez webové rozhranie, riadený automaticky. Experimentálna možnosť manuálneho ovládania výstupu SW tlačidlom z webservera. Prepínanie režimov riadenia vykurovania automat / manual.</td>
<td><a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/martinius96/WiFi-termostat/tree/main/firmware/ESP8266/WiFi_TERMOSTAT_MANUAL_experimental" class="btn btn-success" role="button">ESP8266 firmvér</a></td>
<td><a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/martinius96/WiFi-termostat/tree/main/firmware/ESP32/WiFi_TERMOSTAT_MANUAL_experimental" class="btn btn-danger" role="button">ESP32 firmvér</a></td>
</tr>
</tbody>
</table>
	</div></center>
<p style="text-align: justify;">
Pre nahratie binárneho programu do platformy ESP je potrebné použiť nástroj ESPTOOL.
Nástroj využíva napríklad aj prostredie Arduino IDE pre nahratie programu po kompilácii, alebo aj vývojový framework od Espressif Systems - ESP-IDF.
<b>Pri platforme ESP32 je potrebné do začiatku procesu nahrávania držať tlačidlo BOOT, respektíve urobiť pulldown na GPIO 0 (ak doska nemá BOOT tlačidlo vyvedené).</b>
V priečinku každého firmvéru je pripravený automatizovaný - spustiteľný .bat script (vzorovo pre port COM7 u ESP8266 a COM17 u ESP32), ktorý spustí priložený ESPTOOL a vykoná nahratie programu s konkrétnym firmvérom, ktorý sa v danej zložke nachádza.
<hr>
Cieľový port je nutné pozmeniť na základe COM portu, na ktorom sa prihlási vaša doska / mikrokontróler (možno zistiť cez Správcu periférii a ovládačov, na ktorom COM porte je ESP prihlásené).
Programová implementácia pre ESP8266 predpokladá, že má doska nahraté základné časti flash pamäte - tabuľka partícii a podobne...
Binárny program je výlučne aplikáciou termostatu bez ďalších pribalených častí programu.
Po nahratí programu sa okno programu ESPTOOL automaticky vypne a vykoná softvérový reštart ESP platformy, ktorá následne bootuje nový firmvér a pripravuje WiFi termostat na použitie.
Firmvér pre ESP32 obsahuje naviac aj tabuľku partícii, ktorá sa zapisuje na ofset 0x8000, bootloader na ofset 0x1000. Samotný firmvér je zapísaný na štandardný ofset 0x10000.
</p>				
<center>
	<img src="https://i.imgur.com/Nz4Uryz.png" style="display: block; max-width: 100%; height: auto;" alt="XLoader - Arduino - AVRDUDE - Termostat - Ethernet" title="XLoader - Arduino - AVRDUDE - Termostat - Ethernet">	
</center>
<b>Po úspešnom nahratí binárneho programu - firmvéru je termostat plne pripravený na prevádzku.</b> 
<p style="text-align: justify;">
V prípade, že v jeho flash pamäti nie sú uložené údaje k existujúcej WiFi sieti (napríklad aj zo sketchu nahratého predtým), začne vysielať vlastné SSID - <b>WiFi_TERMOSTAT_AP</b>. 
Po pripojení smartfónom / počítačom do tejto WiFi siete je na adrese <b>192.168.4.1</b> dostupné webové rozhranie WiFi Manager, ktoré poskytuje možnosť konfigurácie WiFi termostatu pre vašu domácu WiFi sieť.
V rozhraní je možné zadať meno a heslo existujúcej WiFi siete, na ktorú sa WiFi termostat pripojí. 
<div class="alert alert-danger">
<strong>Funkcia termostatu je spustená až po pripojení ESP8266 / ESP32 mikrokontroléru do vašej LAN siete! Po pridelení IP adresy pre konektivitu vo vašej sieti.</strong>
</div>	
Po pripojení na domácu WiFi sieť ESP prestáva vysielať SSID, prepne sa do STA (Station) módu a funguje už v režime termostatu, ktorý je možné plne využívať.
Zadané údaje o WiFi sieti sú uložené do flash pamäte termostatu a už ich nie je nutné zadávať znova pri opätovnom spustení termostatu, výpadku napájania, reštartu zariadenia.
V prípade, že daná sieť nie je dostupná, začne ESP opäť vysielať vlastné SSID: <b>WiFi_TERMOSTAT_AP</b> a opätovne je možné zadať prihlasovacie informácie.
Termostat je dostupný na svojej IP adrese (ktorú vypíše každých 10 sekúnd aj na UART), respektíve aj na lokálnom mDNS --> <b><a href="http://wifi-termostat.local">http://wifi-termostat.local</a></b> za predpokladu, že je použitý mDNS firmvér. 
<hr>
Služba mDNS funguje až po pripojení k existujúcej WiFi sieti. V momente, kedy termostat vysiela vlastné SSID, nie je možné na zariadenie pristúpiť cez doménové meno.
<b>V operačnom systéme Windows je nutné povoliť mDNS (Multicast DNS), aby bolo možné na doménové meno s postfixom local pristúpiť! 
V prípade MacOS je možné službu využívať mDNS doménové meno po doinštalovaní aplikácie Bonjour!</b> 
Program funguje na základe schémy zapojenia projektu a logiky z popisu.
		</p>
<center>
<hr>	
<h4>WiFi sieť termostatu v AP režime - Windows Client</h4>	
	<hr>
	<img src="https://i.imgur.com/cJb6DR9.png" style="display: block; max-width: 100%; height: auto;" alt="ESP - WiFi termostat - vysielanie SSID pre konfiguráciu na existujúcu WiFi sieť" title="ESP - WiFi termostat - vysielanie SSID pre konfiguráciu na existujúcu WiFi sieť">	
<hr>	
<h4>WiFi sieť termostatu v AP režime - Android Client</h4>	
<hr>	
<img src="https://i.imgur.com/iZ0JoSY.png" style="display: block; max-width: 100%; height: auto;" alt="WiFi termostat - ESP8266 AP - Android - pripojenie k sieti" title="WiFi termostat - ESP8266 AP - Android - pripojenie k sieti">	
<hr>	
<h4>WiFi sieť termostatu v AP režime - Captive portal - presmerovanie na konfiguráčnu stránku WiFi Managera</h4>	
<hr>	
<img src="https://i.imgur.com/s9ubg0n.png" style="display: block; max-width: 100%; height: auto;" alt="WiFi termostat - ESP8266 AP - Captive Portal" title="WiFi termostat - ESP8266 AP - Captive Portal">	
<hr>	
<h4>WiFi Manager - konfigurácia WiFi siete - hlavné menu - WiFi termostat</h4>
<hr>	
<img src="https://i.imgur.com/2oizcO6.png" style="display: block; max-width: 100%; height: auto;" alt="WiFi termostat - WiFi Manager - konfigurácia existujúcej WLAN siete" title="WiFi termostat - WiFi Manager - konfigurácia existujúcej WLAN siete">
<hr>
<h4>WiFi Manager - výber WiFi siete so silou signálu - RSSI - nastavenie hesla</h4>
<hr>	
<img src="https://i.imgur.com/fbBasd2.png" style="display: block; max-width: 100%; height: auto;" alt="WiFi termostat - WiFi Manager - konfigurácia existujúcej WLAN siete" title="WiFi termostat - WiFi Manager - konfigurácia existujúcej WLAN siete">
<hr>
<h4>WiFi termostat - HTTP webserver - funkčný termostat po pripojení k LAN sieti</h4>
<hr>		
<img src="https://i.imgur.com/nxVXgWU.png" style="display: block; max-width: 100%; height: auto;" alt="Fungujúci WiFi termostat na IP adrese v lokálnej WiFi sieti" title="Fungujúci WiFi termostat na IP adrese v lokálnej WiFi sieti">
<hr>
<h4>WiFi Manager - UART výstup - systémové informácie a výpis logiky</h4>
<hr>
<img src="https://i.imgur.com/f1mF6Fk.png" style="display: block; max-width: 100%; height: auto;" alt="ESP - WiFi termostat - UART výpis - logika systému - ovládanie kotla, pridelená IP adresa v domácej LAN sieti" title="ESP - WiFi termostat - UART výpis - logika systému - ovládanie kotla, pridelená IP adresa v domácej LAN sieti">
</center>
	<hr>
	</div>
		</div>
</div>
</body>
</html>
