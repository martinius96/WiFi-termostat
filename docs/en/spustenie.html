<!DOCTYPE html>
<html lang="en">
<head>
	<!-- Primary Meta Tags -->
	<title>How upload firmware - WiFi thermostat - ESP8266 / ESP32</title>
	<meta name="description" content="Instructions for startup and upload firmware for WiFi thermostat project for WiFi platform ESP8266 and ESP32">
	<meta name="keywords" content="Thermostat, digital, arduino ide, wemos d1 mini, nodemcu, wifi, esp8266, heating, heating, webserver, socket, http, web, ip, ipv4, ds18b20, onewire, 1-wire">
	<!-- Open Graph / Facebook -->
	<meta property="og:type" content="website">
	<meta property="og:url" content="https://martinius96.github.io/WiFi-termostat/en/spustenie.html">
	<meta property="og:title" content="Project launch - WiFi thermostat - ESP8266 / ESP32">
	<meta property="og:description" content="Instructions for installation and launch of the WiFi thermostat project built on the WiFi platform ESP8266 and ESP32">
	<meta property="og:image" content="">

	<!-- Twitter -->
	<meta property="twitter:card" content="summary_large_image">
	<meta property="twitter:url" content="https://martinius96.github.io/WiFi-termostat/en/spustenie.html">
	<meta property="twitter:title" content="Project launch - WiFi thermostat - ESP8266 / ESP32">
	<meta property="twitter:description" content="Instructions for installation and launch of the WiFi thermostat project built on the WiFi platform ESP8266 and ESP32">
	<meta property="twitter:image" content="">
	
	<link rel="icon" type="image/png" href="favicon.png">
	<link rel="sitemap" type="application/xml" title="Sitemap" href="../../sitemap.xml" />
	<meta name="google-site-verification" content="UwZZh2EXv3iWUAi_1Z0hLxVCz6ySJ4UdY_BPoLtejwo" />    	
	<meta property='fb:admins' content='100001242570317'>
    	<meta charset="utf-8">
    	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
	<script type="text/javascript">
    		window.smartlook||(function(d) {
    			var o=smartlook=function(){ o.api.push(arguments)},h=d.getElementsByTagName('head')[0];
    			var c=d.createElement('script');o.api=new Array();c.async=true;c.type='text/javascript';
    			c.charset='utf-8';c.src='https://rec.smartlook.com/recorder.js';h.appendChild(c);
    		})(document);
    		smartlook('init', 'db50efe9fff280a17db52b82be221240cbbd3dbe');
	</script>  
	<style>
		table, th, td {
  			border: 1px solid black;
		}
	</style>
	<style>
	#right {
  position: absolute;
  right: 0px;
}
	</style>
</head>
<body>
	<div class="container">
  		<div class="row">
    			<div class="col-sm-12">
<nav class="navbar navbar-inverse">
  <div class="container-fluid">
    <div class="navbar-header">
      <a class="navbar-brand" href="index.html">WiFi thermostat</a>
    </div>
    <ul class="nav navbar-nav">
      	<li class=""><a href="index.html">Overview</a></li>
	<li><a href="zapojenie.html">Involvement</a></li>      
	<li class="active"><a href="spustenie.html">Firmware</a></li>
  <li><a href="json_client.html">JSON client</a></li>
      	<li><a href="kontakt.html">Contact</a></li>
<a href="../de/spustenie.html"><img src="https://futbalovysen.sk/wp-content/uploads/germany.png" alt="Germany.png, 2,2kB" title="Germany" height="32" width="32"></a>		 
   <a href="../spustenie.html"><img src="https://futbalovysen.sk/wp-content/uploads/slovakia.png" alt="Slovak flag.png, 2,2kB" title="Slovakia" height="32" width="32"></a>
<li style="float: right; "><a href="https://martinius96.github.io/termostat-ethernet/en/" class="btn btn-danger" role="button" title="ZmeniÅ¥ projekt na Ethernet termostat"><img src="https://i.imgur.com/6dW9TvK.png" width=16px height=16px> <font color="white">Ethernet thermostat</font></a></li>  </ul> 
</div>
</nav>  
				<div class="alert alert-success">
					<strong>WiFi thermostat project at Github: </strong><a href="https://github.com/martinius96/WiFi-termostat">WiFi thermostat</a>
				</div>	
<div class="alert alert-danger">
 	<strong>Support the WiFi thermostat project via PayPal. Support will allow you to add new features in the future and open the source code of the application: </strong><a href="https://www.paypal.com/paypalme/chlebovec" class="btn btn-primary" role="button">PayPal donate</a>
</div>	
<span class="label label-default">ESP8266</span>
<span class="label label-primary">ESP32</span>
<span class="label label-success">WiFi</span>
<span class="label label-info">DS18B20</span>
<span class="label label-warning">OneWire</span>
<span class="label label-danger">Dallas</span>
<span class="label label-default">HTML</span>
<span class="label label-primary">Webserver</span>
<span class="label label-success">WebSocket</span>
<span class="label label-info">JSON</span>
<span class="label label-warning">mDNS</span>	
<span class="label label-danger">UART</span>				
<hr><center><h2>Launch of the WiFi thermostat project - ESP8266 / ESP32</h2></center><hr>
<p style="text-align: justify;">
The WiFi thermostat project exists in several versions, which are available on Githube in the repository of the whole project.
Versions differ in functionality only in advanced usage options and remote firmware update options.
The firmware is available in compiled - binary form, which is executable for the target platform.
Therefore, it is tested in advance, compiled for you. The firmware is universal, which guarantees that it will work with the cloned binary program on all microcontrollers in the same way.
<div class="alert alert-danger">
	<b>The free version is available only in the form of a compiled - binary program without access to an application written in .ino format.</b>
</div>	
</p>
<hr><center><h2>Firmware distribution based on supported WiFi platforms</h2></center><hr>
<li><b>ESP8266</b> - target platform with ESP8266 chip in versions 12E to 12F (conditioned by flash DIO method)</li>
<li><b>ESP32</b> - target platform with ESP-32S chip (AI-Thinker), ESP32-WROOM-32 (Espressif Systems)</li>
<hr><center><h2>Firmware distribution by function</h2></center><hr>
<div class="alert alert-info">
 	<strong> Available firmware (.bin) for ESP8266 and ESP32 microcontrollers.</strong> Firmware upload is done via esptool - part of the downloaded .zip firmware archive.
</div>	
			<center>
<div class="table-responsive">   
<table class="table" style="border: 1px solid black;">
<thead>
<tr>
<th>Firmware name</th>
<th>Firmware features</th>
<th>ESP8266</th>
<th>ESP32</th>
</tr>
</thead>
<tbody>
<tr>
<td><b>WiFi_TERMOSTAT</font></b></td>
<td>Thermostat with the possibility of setting the target temperature and hysteresis via a web interface, controlled automatically</td>
<td><a href="https://download-directory.github.io/?url=https%3A%2F%2Fgithub.com%2Fmartinius96%2FWiFi-termostat%2Ftree%2Fmain%2Ffirmware%2FESP8266%2Fen%2FWiFi_THERMOSTAT" class="btn btn-success" role="button">ESP8266 EN firmware</a></td>
<td><a href="https://download-directory.github.io/?url=https%3A%2F%2Fgithub.com%2Fmartinius96%2FWiFi-termostat%2Ftree%2Fmain%2Ffirmware%2FESP32%2Fen%2FWiFi_THERMOSTAT" class="btn btn-danger" role="button">ESP32 EN firmware</a></td>
</tr>
<tr>
<td><b>WiFi_TERMOSTAT_mDNS</b></td>
<td>Thermostat with the possibility of setting the target temperature and hysteresis via a web interface, controlled automatically. Possibility to use a domain name within the LAN network (mDNS record) for connection with thermostat</td>
<td><a href="https://download-directory.github.io/?url=https%3A%2F%2Fgithub.com%2Fmartinius96%2FWiFi-termostat%2Ftree%2Fmain%2Ffirmware%2FESP8266%2Fen%2FWiFi_THERMOSTAT_mDNS" class="btn btn-success" role="button">ESP8266 EN firmware</a></td>
<td><a href="https://download-directory.github.io/?url=https%3A%2F%2Fgithub.com%2Fmartinius96%2FWiFi-termostat%2Ftree%2Fmain%2Ffirmware%2FESP32%2Fen%2FWiFi_Thermostat_mDNS" class="btn btn-danger" role="button">ESP32 EN firmware</a></td>
</tr>
<tr>
<td><b>WiFi_TERMOSTAT_MANUAL_experimental</b></td>
<td>Thermostat with the possibility of setting the target temperature and hysteresis via a web interface, controlled automatically. Experimental possibility of manual control of SW output by a button from a web server. Switching heating control modes automatic / manual.</td>
<td><a href="https://download-directory.github.io/?url=https%3A%2F%2Fgithub.com%2Fmartinius96%2FWiFi-termostat%2Ftree%2Fmain%2Ffirmware%2FESP8266%2FWiFi_TERMOSTAT_MANUAL_experimental" class="btn btn-success" role="button">ESP8266 SK firmware</a></td>
<td><a href="https://download-directory.github.io/?url=https%3A%2F%2Fgithub.com%2Fmartinius96%2FWiFi-termostat%2Ftree%2Fmain%2Ffirmware%2FESP32%2FWiFi_TERMOSTAT_MANUAL_experimental" class="btn btn-danger" role="button">ESP32 SK firmware</a></td>
</tr>
</tbody>
</table>
	</div></center>
<p style="text-align: justify;">
To upload the binary program to the ESP platform, it is necessary to use the ESPTOOL tool.
The tool also uses, for example, the Arduino IDE environment for uploading the program after compilation, or the development framework from Espressif Systems - ESP-IDF.
<b> For the ESP32 platform, it is necessary to hold the BOOT button until the beginning of the "Connecting ........_____....." recording process, or to do a pulldown on GPIO 0 (if the development kit does not have a BOOT button on the board ). </b>
An automated - executable .bat script is prepared in the folder of each firmware (it has a set COM port of the microcontroller set to COM7 for ESP8266 and COM17 for ESP32), which starts the enclosed ESPTOOL and loads the program with the specific firmware located in the given folder.
</p>
<center>
	<img src="https://i.imgur.com/M0U6HkC.png" style="display: block; max-width: 100%; height: auto;" alt="Device Manager - Windows - a registered ESP microcontroller" title="Device Manager - Windows - a registered ESP microcontroller">	
</center>
<p style="text-align: justify;">
<b> <font color = "red"> The destination COM port must be changed based on the COM port on which your board / microcontroller logs in </font> </b> - (can be found via the Peripherals and Drivers Manager on which COM port is ESP logged in).
<b> The ESP8266 microcontroller on the NodeMCU / Wemos D1 Mini development kits most often has a CH340 USB-UART converter and also acts in the device manager under this name.
In the case of the ESP32 microcontroller, the most commonly used USB-UART converter is CP2102 from Silicon Labs - referred to as the CP210X USB UART Bridge. </b>
The program implementation for ESP8266 assumes that the board has loaded the basic parts of the flash memory - the partition table and so on ...
The binary program is exclusively a thermostat application without other bundled parts of the program.
After loading the program, the ESPTOOL program window automatically shuts down and performs a software restart of the ESP platform, which then boots the new firmware and prepares the WiFi thermostat for use.
For the ESP8266 microcontroller, the firmware is written to the standard offset 0x00000 - (the partition table is not part of the firmware, it is not required).
The firmware for ESP32 also contains a partition table that is written to offset 0x8000, the bootloader to offset 0x1000. The firmware itself is written to the standard offset 0x10000.
</p>				
<center>
	<img src="https://i.imgur.com/Nz4Uryz.png" style="display: block; max-width: 100%; height: auto;" alt="ESPTOOL - a tool for uploading firmware to the ESP8266 / ESP32 microcontroller" title="ESPTOOL - a tool for uploading firmware to the ESP8266 / ESP32 microcontroller">	
</center>
<b>After successful loading of the binary program - firmware, the thermostat is fully ready for operation.</b> 
<p style="text-align: justify;">
If the data on the existing WiFi network is not stored in its flash memory (for example, also from a sketch recorded before), it will start broadcasting its own SSID - <b> WiFi_TERMOSTAT_AP </b>.
After connecting to a WiFi network with a smartphone / computer, the WiFi Manager web interface is available at <b> 192.168.4.1 </b>, which provides the option of configuring a WiFi thermostat for your home WiFi network.
In the interface it is possible to enter the name and password of the existing WiFi network to which the WiFi thermostat will connect.
<div class="alert alert-danger">
<strong>WiFi thermostat is uperational only after successful connection to your LAN network! After assigning an IP address for connectivity on your network.</strong>
</div>	
After connecting to the home WiFi network, the ESP stops broadcasting the SSID, switches to STA (Station) mode and already works in thermostat mode
The entered data about the WiFi network are stored in the flash memory of the thermostat and it is no longer necessary to enter them again when restarting the thermostat, power failure, device restart.
If the network is not available, ESP will start broadcasting its own SSID again: <b> WiFi_TERMOSTAT_AP </b> and you can re-enter your credentials.
The thermostat is available on its IP address (which it prints every 10 seconds also on the UART), or on the local mDNS -> <b> http: //WiFi-termostat.local </b>. The mDNS service only works after connecting to an existing WiFi network.
Once the thermostat is transmitting its own SSID, it is not possible to access the device via a domain name.
The program works on the basis of the project wiring diagram and the logic from the description. </b>
		</p>
<center>
<hr>	
<h4>WiFi thermostat settings (ESP8266 / ESP32) via WiFiManager</h4>	
<hr>	
<img src="https://i.imgur.com/nLqT6Y0.gif" style="display: block; max-width: 100%; height: auto;" alt="WiFi thermostat - ESP8266 / ESP32 - Android - network connection via WiFiManager" title="WiFi thermostat - ESP8266 / ESP32 - Android - network connection via WiFiManager">	
<hr>
<h4>WiFi thermostat - HTTP web server - functional thermostat after connecting to the LAN network</h4>
<hr>		
<div class="alert alert-info">
 	<strong>Refresh the web interface automatically every 30 seconds</strong>
</div>	
<img src="https://i.imgur.com/dBXiDLN.png" style="display: block; max-width: 100%; height: auto;" alt="A working WiFi thermostat at an IP address in the local WiFi network available to clients" title="A working WiFi thermostat at an IP address in the local WiFi network available to clients">
<hr>
<h4>WiFiManager - UART output - system information and logic listing</h4>
<hr>
<div class="alert alert-info">
 	<strong>Output to UART automatically every 10 seconds + temperature measurement on the OneWire bus by the DS18B20 sensor</strong>
</div>	
<img src="https://i.imgur.com/gWm9izE.png" style="display: block; max-width: 100%; height: auto;" alt="ESP - WiFi thermostat - UART statement - system logic - boiler control, assigned IP address in the home LAN" title="ESP - WiFi thermostat - UART statement - system logic - boiler control, assigned IP address in the home LAN">
</center>
	<hr>
	</div>
		</div>
</div>
</body>
</html>
